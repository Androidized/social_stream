<section id="site_client">
  <%= render partial: 'toolbar/home' %>

  <section class="site_client" id="<%= dom_id resource %>">
    <header>  
      <h4>
        <%= resource.name %>
      </h4>
      <% if can?(:update, resource) %>
          <%= link_to t('site.client.button.edit'), polymorphic_path(resource, action: 'edit'), class: "edit" %>
        <% end %>
    </header>

    <div class="content">
      <%= image_tag(resource.logo.url(:medium), class: "logo-app pull-right") %>
      <div class="gereral-info">      
        <h4>
          <%= Site::Client.human_attribute_name :description %>
        </h4>
        <div class="result">
          <%= resource.description%>
        </div>

        <h4>
          <%= Site::Client.human_attribute_name :url %>
        </h4>
        <div class="result">
          <%= link_to resource.url, resource.url%>
        </div>

        <% if can? :update, resource %>
          <h4>
            <%= Site::Client.human_attribute_name :callback_url %>
          </h4>
          <div class="result">
            <p>
              <%= resource.callback_url %>
            </p>
          </div>
        <% end %>
      </div>
        
      <% if can? :update_secret, resource %>
        <div class="panel-group" id="accordion2">
          <div class="panel panel-default">
            <div class="panel-heading">
              <h6 class="panel-title">
                <a data-toggle="collapse" data-parent="#accordion2" href="#collapseOne">
                  <%= t 'site.client.oauth.credentials' %>
                </a>
              </h6>
            </div>
            <div id="collapseOne" class="panel-collapse collapse">
              <div class="panel-body">
                <div class="client-id">
                  <header>
                    <%= Site::Client.human_attribute_name :id %>
                  </header>
                  <div class="result">
                    <p>
                      <%= resource.id %>
                    </p>
                  </div>
                </div>
                <div class="client-secret">
                  <header>
                    <%= Site::Client.human_attribute_name :secret %>
                    <%= form_tag update_secret_site_client_path(resource, format: :json), class: "site-client-secret" do %>
                      <%= submit_tag t('site.client.oauth.secret.refresh'), class: 'pull-right' %>
                    <% end %>
                  </header>
                  <div class="result">
                    <p>
                      <span class="site-client-secret"><%= resource.secret %></span>
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
    <div class="user-zone">
      <h5 class="lead">Authorized
      </h5>

      <%= text_field_tag "contact-filter", "", placeholder: "filter", autocomplete: "off" %>
      
      <%= render partial: 'contacts/add_button',
                     locals: {
                       sender: resource,
                       type: [ :user, :group ]
                     }
          %>
      
      <div class="tab-content">
        <div class="tab-pane active" id="authorized">

          <%= render partial: 'contacts/contact',
                     collection: resource.sent_contacts.first(12) %>
        </div>
      </div>
    </div>
  </section>

  <%= javascript_tag do %>
    SocialStream.SiteClient.show();
  <% end %>
</section>
